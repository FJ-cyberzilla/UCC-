<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ultimate Username Checker</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .platform-card { transition: all 0.3s ease; }
        .platform-card:hover { transform: translateY(-2px); }
        .available { border-left: 4px solid #10B981; }
        .taken { border-left: 4px solid #EF4444; }
        .error { border-left: 4px solid #F59E0B; }
        .loading { opacity: 0.6; pointer-events: none; }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <!-- Header -->
        <header class="text-center mb-12">
            <h1 class="text-4xl font-bold text-gray-800 mb-2">
                <i class="fas fa-user-check text-blue-500 mr-3"></i>
                Ultimate Username Checker
            </h1>
            <p class="text-gray-600">Check username availability across 50+ platforms</p>
        </header>

        <!-- Main Tabs -->
        <div class="bg-white rounded-lg shadow-lg mb-8">
            <div class="border-b">
                <nav class="flex -mb-px">
                    <button id="singleTab" class="tab-button py-4 px-6 text-center border-b-2 border-blue-500 text-blue-500 font-medium w-1/3">
                        <i class="fas fa-user mr-2"></i>Single Check
                    </button>
                    <button id="batchTab" class="tab-button py-4 px-6 text-center border-b-2 border-transparent text-gray-500 hover:text-gray-700 font-medium w-1/3">
                        <i class="fas fa-users mr-2"></i>Batch Check
                    </button>
                    <button id="generateTab" class="tab-button py-4 px-6 text-center border-b-2 border-transparent text-gray-500 hover:text-gray-700 font-medium w-1/3">
                        <i class="fas fa-magic mr-2"></i>Generate
                    </button>
                </nav>
            </div>

            <!-- Single Check Tab -->
            <div id="singleContent" class="tab-content p-6">
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Username to Check</label>
                    <div class="flex space-x-4">
                        <input type="text" id="usernameInput" placeholder="Enter username..." 
                               class="flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <button onclick="checkSingleUsername()" class="px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors">
                            <i class="fas fa-search mr-2"></i>Check
                        </button>
                    </div>
                </div>
                
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Platforms (optional)</label>
                    <input type="text" id="platformsInput" placeholder="facebook,twitter,instagram... or leave empty for all" 
                           class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                </div>

                <div id="singleResults" class="mt-8 hidden">
                    <h3 class="text-lg font-semibold mb-4">Results for "<span id="resultsUsername"></span>"</h3>
                    <div id="resultsGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"></div>
                </div>
            </div>

            <!-- Batch Check Tab -->
            <div id="batchContent" class="tab-content p-6 hidden">
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Usernames (one per line)</label>
                    <textarea id="batchUsernames" rows="6" placeholder="Enter usernames, one per line..."
                              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                </div>
                
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Platforms (optional)</label>
                    <input type="text" id="batchPlatforms" placeholder="facebook,twitter,instagram... or leave empty for all" 
                           class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                </div>

                <button onclick="checkBatchUsernames()" class="px-6 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors">
                    <i class="fas fa-users mr-2"></i>Check Batch
                </button>

                <div id="batchResults" class="mt-8 hidden">
                    <h3 class="text-lg font-semibold mb-4">Batch Results</h3>
                    <div id="batchResultsContent"></div>
                </div>
            </div>

            <!-- Generate Tab -->
            <div id="generateContent" class="tab-content p-6 hidden">
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Base Words (comma separated)</label>
                    <input type="text" id="baseWords" placeholder="tech,web,digital,code..." 
                           class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Count</label>
                        <input type="number" id="generateCount" value="10" min="1" max="50"
                               class="w-full px-4 py-2 border border-gray-300 rounded-lg">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Style</label>
                        <select id="generateStyle" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
                            <option value="combined">Combined</option>
                            <option value="simple">Simple</option>
                            <option value="numbers">With Numbers</option>
                            <option value="specialchars">With Special Chars</option>
                        </select>
                    </div>
                    <div class="flex items-end">
                        <button onclick="generateUsernames()" class="w-full px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors">
                            <i class="fas fa-magic mr-2"></i>Generate
                        </button>
                    </div>
                </div>

                <div id="generateResults" class="hidden">
                    <h3 class="text-lg font-semibold mb-4">Generated Usernames</h3>
                    <div id="generatedList" class="bg-gray-50 rounded-lg p-4"></div>
                </div>
            </div>
        </div>

        <!-- Export Section -->
        <div id="exportSection" class="bg-white rounded-lg shadow-lg p-6 hidden">
            <h3 class="text-lg font-semibold mb-4">Export Results</h3>
            <div class="flex space-x-4">
                <button onclick="exportResults('json')" class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors">
                    <i class="fas fa-file-code mr-2"></i>JSON
                </button>
                <button onclick="exportResults('csv')" class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors">
                    <i class="fas fa-file-csv mr-2"></i>CSV
                </button>
                <button onclick="exportResults('txt')" class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:blue-600 transition-colors">
                    <i class="fas fa-file-alt mr-2"></i>TXT
                </button>
            </div>
        </div>
    </div>

    <script>
        let currentResults = {};
        
        // Tab management
        document.querySelectorAll('.tab-button').forEach(button => {
            button.addEventListener('click', (e) => {
                // Update tabs
                document.querySelectorAll('.tab-button').forEach(btn => {
                    btn.classList.remove('border-blue-500', 'text-blue-500');
                    btn.classList.add('border-transparent', 'text-gray-500');
                });
                e.target.classList.add('border-blue-500', 'text-blue-500');
                e.target.classList.remove('border-transparent', 'text-gray-500');
                
                // Update content
                document.querySelectorAll('.tab-content').forEach(content => {
                    content.classList.add('hidden');
                });
                
                const contentId = e.target.id.replace('Tab', 'Content');
                document.getElementById(contentId).classList.remove('hidden');
            });
        });

        async function checkSingleUsername() {
            const username = document.getElementById('usernameInput').value.trim();
            const platforms = document.getElementById('platformsInput').value.trim();
            
            if (!username) {
                alert('Please enter a username');
                return;
            }
            
            document.body.classList.add('loading');
            
            try {
                const response = await fetch('/check', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        username: username,
                        platforms: platforms ? platforms.split(',').map(p => p.trim()) : null
                    })
                });
                
                const results = await response.json();
                
                if (response.ok) {
                    currentResults = results;
                    displaySingleResults(results, username);
                    document.getElementById('exportSection').classList.remove('hidden');
                } else {
                    alert('Error: ' + results.error);
                }
            } catch (error) {
                alert('Error checking username: ' + error.message);
            }
            
            document.body.classList.remove('loading');
        }

        function displaySingleResults(results, username) {
            document.getElementById('resultsUsername').textContent = username;
            const grid = document.getElementById('resultsGrid');
            grid.innerHTML = '';
            
            Object.entries(results).forEach(([platform, status]) => {
                const card = document.createElement('div');
                card.className = `platform-card bg-white rounded-lg shadow-md p-4 ${getStatusClass(status)}`;
                
                const statusIcon = status === 'available' ? 'fa-check-circle text-green-500' : 
                                 status === 'taken' ? 'fa-times-circle text-red-500' : 
                                 'fa-exclamation-circle text-yellow-500';
                
                const statusText = status === 'available' ? 'Available' : 
                                  status === 'taken' ? 'Taken' : 'Error';
                
                card.innerHTML = `
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <i class="fas fa-globe text-gray-400 mr-3"></i>
                            <span class="font-medium">${platform}</span>
                        </div>
                        <div class="flex items-center">
                            <i class="fas ${statusIcon} mr-2"></i>
                            <span class="text-sm font-medium">${statusText}</span>
                        </div>
                    </div>
                `;
                
                grid.appendChild(card);
            });
            
            document.getElementById('singleResults').classList.remove('hidden');
        }

        async function checkBatchUsernames() {
            const usernamesText = document.getElementById('batchUsernames').value.trim();
            const platforms = document.getElementById('batchPlatforms').value.trim();
            
            if (!usernamesText) {
                alert('Please enter usernames');
                return;
            }
            
            document.body.classList.add('loading');
            
            try {
                const response = await fetch('/batch-check', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        usernames: usernamesText,
                        platforms: platforms ? platforms.split(',').map(p => p.trim()) : null
                    })
                });
                
                const results = await response.json();
                
                if (response.ok) {
                    currentResults = results;
                    displayBatchResults(results);
                    document.getElementById('exportSection').classList.remove('hidden');
                } else {
                    alert('Error: ' + results.error);
                }
            } catch (error) {
                alert('Error checking usernames: ' + error.message);
            }
            
            document.body.classList.remove('loading');
        }

        function displayBatchResults(results) {
            const content = document.getElementById('batchResultsContent');
            content.innerHTML = '';
            
            Object.entries(results).forEach(([username, platforms]) => {
                const section = document.createElement('div');
                section.className = 'mb-6';
                section.innerHTML = `<h4 class="font-semibold mb-2">${username}</h4>`;
                
                const platformGrid = document.createElement('div');
                platformGrid.className = 'grid grid-cols-2 md:grid-cols-3 gap-2 ml-4';
                
                Object.entries(platforms).forEach(([platform, status]) => {
                    const badge = document.createElement('span');
                    badge.className = `inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${
                        status === 'available' ? 'bg-green-100 text-green-800' :
                        status === 'taken' ? 'bg-red-100 text-red-800' :
                        'bg-yellow-100 text-yellow-800'
                    }`;
                    badge.innerHTML = `
                        ${platform}: 
                        <i class="fas ${
                            status === 'available' ? 'fa-check ml-1' :
                            status === 'taken' ? 'fa-times ml-1' :
                            'fa-exclamation ml-1'
                        }"></i>
                    `;
                    platformGrid.appendChild(badge);
                });
                
                section.appendChild(platformGrid);
                content.appendChild(section);
            });
            
            document.getElementById('batchResults').classList.remove('hidden');
        }

        async function generateUsernames() {
            const baseWords = document.getElementById('baseWords').value.trim();
            const count = document.getElementById('generateCount').value;
            const style = document.getElementById('generateStyle').value;
            
            if (!baseWords) {
                alert('Please enter base words');
                return;
            }
            
            document.body.classList.add('loading');
            
            try {
                const response = await fetch('/generate', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        base_words: baseWords,
                        count: count,
                        style: style
                    })
                });
                
                const results = await response.json();
                
                if (response.ok) {
                    displayGeneratedUsernames(results.usernames);
                } else {
                    alert('Error: ' + results.error);
                }
            } catch (error) {
                alert('Error generating usernames: ' + error.message);
            }
            
            document.body.classList.remove('loading');
        }

        function displayGeneratedUsernames(usernames) {
            const list = document.getElementById('generatedList');
            list.innerHTML = '';
            
            usernames.forEach(username => {
                const item = document.createElement('div');
                item.className = 'flex justify-between items-center py-2 border-b border-gray-200 last:border-b-0';
                item.innerHTML = `
                    <span class="font-mono">${username}</span>
                    <button onclick="checkGeneratedUsername('${username}')" class="text-blue-500 hover:text-blue-700 text-sm">
                        <i class="fas fa-search mr-1"></i>Check
                    </button>
                `;
                list.appendChild(item);
            });
            
            document.getElementById('generateResults').classList.remove('hidden');
        }

        function checkGeneratedUsername(username) {
            document.getElementById('usernameInput').value = username;
            document.querySelector('#singleTab').click();
            setTimeout(() => checkSingleUsername(), 100);
        }

        async function exportResults(format) {
            if (Object.keys(currentResults).length === 0) {
                alert('No results to export');
                return;
            }
            
            try {
                const response = await fetch('/export', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        results: currentResults,
                        format: format
                    })
                });
                
                const result = await response.json();
                
                if (response.ok) {
                    // Download the file
                    window.open(`/download/${result.filename}`, '_blank');
                } else {
                    alert('Error: ' + result.error);
                }
            } catch (error) {
                alert('Error exporting results: ' + error.message);
            }
        }

        function getStatusClass(status) {
            return status === 'available' ? 'available' :
                   status === 'taken' ? 'taken' : 'error';
        }
    </script>
</body>
</html>
